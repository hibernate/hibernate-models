
group = "org.hibernate.models"

// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// Version handling
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

def versionFile = rootProject.file( "version.txt" )
def releaseVersion = determineVersion("releaseVersion", versionFile )
def developmentVersion = determineVersion("developmentVersion", versionFile)

project.version = releaseVersion != null
		? releaseVersion
		: developmentVersion

ext.versionFile = versionFile
ext.releaseVersion = releaseVersion
ext.developmentVersion = developmentVersion


private String determineVersion(String type, File versionFile) {
	if ( project.hasProperty( type ) ) {
		// only use the provided value if it is non-empty
		def incomingValue = project.property( type ) as String
		if ( incomingValue != null && incomingValue.trim().length() > 0 ) {
			return incomingValue
		}
	}

	def versionFileVersion = versionFile.text.trim()
	// make sure we have a version
	if ( versionFileVersion.length() <= 0 ) {
		throw new RuntimeException("Project version unknown")
	}
	return versionFileVersion
}